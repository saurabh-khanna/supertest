---
title: Active Learning and Student Achievement - Experimental Analysis
date: "`r Sys.Date()`"
output: 
  pdf_document:
    toc: true
    toc_depth: 3
    number_sections: true
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(message = FALSE, warning = FALSE, echo = FALSE, fig.retina = 4)
```


```{r message=FALSE, warning=FALSE}
# Libraries
library(tidyverse)
library(haven)
library(texreg)
library(estimatr)
library(tinytex)

# Parameters
stufac_file <- here::here("data", "all_appended.dta")
stu_file <- here::here("data", "stu_admin_all_latest.dta")
```


```{r}
# Read in data
df_stu <- 
  read_dta(stu_file) %>% 
  mutate(
    female = gender - 1,
    age = 2017 - lubridate::year(b_birthdate)
  ) %>% 
  filter(ea_stud_group_criteria == 2)

# df <- 
#   read_dta(stufac_file) %>% 
#   inner_join(
#     df_stu %>% 
#       select(stdid, classid, starts_with("z_active")) %>% summary(),
#     by = "stdid"
#   )
```


# Student level active learning

## Critical Thinking

```{r}
lm1 <-
  df_stu %>%
  lm_robust(e_ct_score ~ z_active + b_ct_score, data = ., fixed_effects = ~ classid, se_type = "stata")

lm2 <-
  df_stu %>%
  lm_robust(e_ct_score ~ z_active + b_ct_score + female + age + father_ed_ind + mother_ed_ind, data = ., fixed_effects = ~ classid, se_type = "stata")

screenreg(list(lm1, lm2))
```

